use Cwd;
my $this = shift;
my $toolsDir = Foswiki::Configure::Package::_mapTarget($this->{_root}, 'tools/');
my $fixencodingscript = Foswiki::Configure::Package::_mapTarget($this->{_root}, 'tools/taskfixencoding');

my @returnMessages = ();

my $originalCwd = cwd;
chdir $toolsDir;
push(@returnMessages, "Running on standard host...\n");
eval {
	push(@returnMessages, `$fixencodingscript --nodry`);
};
if($@){
	push(@returnMessages, "This did not work...\n");
}
push(@returnMessages, "Running on virtual hosts...\n");
eval {
	push(@returnMessages, `$fixencodingscript --host=all --nodry`);
};
if($@){
	push(@returnMessages, "This did not work...");
}

chdir $originalCwd;
return "TasksAPIPlugin postinstall:\n" . join("", @returnMessages);
