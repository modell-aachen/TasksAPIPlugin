!function(a){function b(a){var b=[foswiki.getPreference("SCRIPTURLPATH"),"/rest",foswiki.getPreference("SCRIPTSUFFIX")].join("");return b+(/^\//.test(a)?a:"/"+a)}function c(c,d){var e=a.Deferred(),f=b("/TasksAPIPlugin/"+c);return a.ajax({url:f,type:"POST",dataType:"json",data:d,error:function(a,b,c){e.reject({error:c,request:a,status:b})},success:function(b){var c;c="string"==typeof b?a.parseJSON(b):b,e.resolve(c)}}),e.promise()}a.taskapi={opts:{limit:9999},create:function(a){return c("create",a)},get:function(c,d,e){d&&/^\d+$/.test(d)!==!1||(d=this.opts&&this.opts.limit||9999,c||(c="")),e&&/^\d+$/.test(e)!==!1||(e=0);var f=a.Deferred(),g=b("/SolrPlugin/search"),h="type: task ";return c&&(/type:\s?task/.test(c)?h=c:h+=c),a.ajax({url:g+"?q="+h+"&rows="+d+"&start="+e,type:"GET",dataType:"json",error:function(a,b,c){f.reject({error:c,request:a,status:b})},success:function(b){var c;c="string"==typeof b?a.parseJSON(b):b,f.resolve(c)}}),f.promise()},getAll:function(a,b){return this.get("type:task",a,b)},getBy:function(a,b,c){var d=["type:task"];if("object"==typeof a)for(var e in a)d.push(e+":"+a[e]);else"string"==typeof a&&d.push(a);return this.get(d.join(" "),b,c)},update:function(a){return c("update",a)},multiupdate:function(a){return c("multiupdate",a)}}}(jQuery);