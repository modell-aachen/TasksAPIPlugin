!function(a){function b(a){var b=[foswiki.getPreference("SCRIPTURLPATH"),"/rest",foswiki.getPreference("SCRIPTSUFFIX")].join("");return b+(/^\//.test(a)?a:"/"+a)}function c(c,d){var e=a.Deferred(),f=b("/TasksAPIPlugin/"+c);return a.ajax({url:f,type:"POST",dataType:"json",data:d,error:function(a,b,c){e.reject({error:c,request:a,status:b})},success:function(b){var c;c="string"==typeof b?a.parseJSON(b):b,e.resolve(c)}}),e.promise()}a.taskapi={opts:{limit:9999},create:function(a){return c("create",a)},get:function(c){"string"==typeof c.query&&(c.query=a.parseJSON(c.query));var d=a.Deferred(),e=b("/TasksAPIPlugin/search");return a.ajax({url:e,type:"POST",data:{request:JSON.stringify(c),topic:foswiki.preferences.WEB+"."+foswiki.preferences.TOPIC},dataType:"json",error:function(a,b,c){d.reject({error:c,request:a,status:b})},success:function(b){var c;c="string"==typeof b?a.parseJSON(b):b,d.resolve(c)}}),d.promise()},getAll:function(a,b,c){return this.get({},a,b,c)},getBy:function(a,b,c,d){return this.get(a,b,c,d)},update:function(a){return c("update",a)},multiupdate:function(a){return c("multiupdate",a)}}}(jQuery);